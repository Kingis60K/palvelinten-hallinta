# h4 - Demonit

## x) Lue ja tiivistä. (Tässä x-alakohdassa ei tarvitse tehdä testejä tietokoneella, vain lukeminen tai kuunteleminen ja tiivistelmä riittää. Tiivistämiseen riittää muutama ranskalainen viiva.)

### Karvinen 2023: Salt Vagrant - automatically provision one master and two slaves
- Infra as Code - Your wishes as a text file

Tässä on yksinkertaisuudessaan siis luotu kansio ja tiedosto. Tiedoston sisältö näytetty 'cat' komennolla ja lopulta saltilla kutsutaan orjia eristyismaininnalla "hello" configuraation käyttö.

Nämä on haettu sivulta: https://terokarvinen.com/2023/salt-vagrant/#infra-as-code---your-wishes-as-a-text-file (Tero Karvinen 2023, luettu 19.11.2023)

 ```
$ sudo mkdir -p /srv/salt/hello
$ sudoedit /srv/salt/hello/init.sls

$ cat /srv/salt/hello/init.sls
/tmp/infra-as-code:
  file.managed

$ sudo salt '*' state.apply hello
```

- top.sls

Tässä myös tehty tiedosto. Tällä kertaa top.sls, joka kertoo siis kaikkien tämän ympäristön orjien käyttävän "hello" configuraatiota.

 ```
$ sudo salt '*' state.apply hello^C
$ sudoedit /srv/salt/top.sls
$ cat /srv/salt/top.sls
base:
  '*':
    - hello

 ```
 ```
$ sudo salt '*' state.apply
   ```


### Salt contributors: Salt overview
Ohjeena käytin sivustoa: https://docs.saltproject.io/salt/user-guide/en/latest/topics/overview.html#rules-of-yaml
- Rules of YAML

YAML on merkintäkieli Saltissa. YAML kokoaa datan python muotoon, jotta Salt voi käyttää sitä.

- YAML simple structure

YAML koostuu kolmesta perustyypistä: skalaari, lista, sanakirja.

- Lists and dictionaries - YAML block structures

YAML koostuu lohkorakenteesta, 2 sisennystä on standardi määrä YAML:ia käytettäessä.


### Salt contributors: Salt states
Nämä on haettu sivulta: https://docs.saltproject.io/salt/user-guide/en/latest/topics/states.html#state-modules
- State modules

Tilamoduulit kutsuvat vastaparejaan suoritusmoduuleja ja joko lisäävät tai rajoittavat asetuksia suoritusmoduulista tilakkaita operaatioita varten.

- The state SLS data structure

Tietoa SLS data struktuurista ja mistä se koostuu. Data abstraktointi normalisoi ja vähentää vaadittavan koodin määrää.

- Organizing states

Salt statet on tarkoitus tehdä yksinkertaiseksi ja helppolukuiseksi

-  the top.sls file

Top.sls tiedostolla voidaan laittaa orjat rooleihin, jolloin voidaan valita mitä komentoja orjaryhmät tekevät.

- Create the SSH state, Create the Apache state

SSH state ja Apache tiedoston 

- Katso näitä alakohtia kriittisin silmin. Teron huomioita ja suosituksia:
Namevar: itse asia tilan id:ksi, name arvoksi tulee automaattisesti sama. Puuttuko esimerkeistä service-watch? Jos asetustiedosto päivittyy herralla, tuleeko se koskaan käyttöön orjilla?

Esimerkeissä ei ole service-watchia. Jälkimmäisestä en osaa sanoa.

- Karvinen 2018: Pkg-File-Service – Control Daemons with Salt – Change SSH Server Port

Configuration maanger systeemillä voi hallita valtavaa määrää demoneita. Ohjeet SSH staten tekoon.


# References
- https://terokarvinen.com/2023/configuration-management-2023-autumn/#h4-demonit
- https://terokarvinen.com/2023/salt-vagrant/#infra-as-code---your-wishes-as-a-text-file
- https://docs.saltproject.io/salt/user-guide/en/latest/topics/overview.html#rules-of-yaml
- https://docs.saltproject.io/salt/user-guide/en/latest/topics/states.html#state-modules
- https://terokarvinen.com/2018/04/03/pkg-file-service-control-daemons-with-salt-change-ssh-server-port/?fromSearch=karvinen%20salt%20ssh
